function Approval(){this.dataCount=""}Approval.prototype={throttle:function(a,t){clearTimeout(a.tId),a.tId=setTimeout(function(){a.call(t)},200)},touchThrottle:function(a,t,e){var n=null,s=new Date;return function(){var o=this,i=arguments,l=new Date;clearTimeout(n),l-s>=e?(a.apply(o,i),s=l):n=setTimeout(function(){a.apply(o,i)},t)}},getData:function(a,t,e){var n=this;$.ajax({url:getRoothPath+"/ddExpenses/expenseInfo/mySponsoredList",data:{userID:a,pageNum:t,pageSize:e},success:function(a){if("{}"===JSON.stringify(a))return $my.messageInfo.html("暂无数据").fadeIn("fast").delay("1000").fadeOut("slow"),!1;switch(a.status){case"true":var t=a.info;if(n.dataCount=t.dataCount,"{}"===JSON.stringify(t))return void $my.messageInfo.html("返回信息为空").fadeIn("fast").delay("1000").fadeOut("slow");var s=t.data;if(!s.length)return $(".loading").hide(),void $my.messageInfo.html("暂无信息").fadeIn("fast").delay("1000").fadeOut("slow");s.length<e&&($(".loading").hide(),$my.lodingText.classList.add("lodingText_show")),n.renderElement(s);break;case"failure":$my.messageInfo.html("查询错误").fadeIn("fast").delay("1000").fadeOut("slow")}}})},renderElement:function(a){for(var t="",e="",n="",s=0;s<a.length;s++){var o=a[s].expenseState;switch(o){case"审核中":e='<li class="underReview" data-detailid='+a[s].id+" data-status=0>",n='<p class="status"><span class="glyphicon glyphicon-exclamation-sign my-icon"></span>&nbsp;&nbsp;<span>'+o+"</span></p>";break;case"已通过":e='<li class="passed" data-detailid='+a[s].id+" data-status=1>",n='<p class="status"><span class="iconfont icon-tongguo my-icon"></span>&nbsp;&nbsp;<span>'+o+"</span></p>";break;case"已拒绝":e='<li class="refused" data-detailid='+a[s].id+" data-status=2>",n='<p class="status"><span class="iconfont icon-ttpodicon my-icon"></span>&nbsp;&nbsp;<span>'+o+"</span></p>"}t+=""+e,t+='<div class="container-fluid myContainer">',t+='<div class="row my-row">',t+='<div class="col-xs-3 col-sm-3 col-md-3 my-col ">',t+='<span class="peopleName nowrap text-center">'+a[s].ExpenseUserName+"</span>",t+="</div>",t+='<div class="col-xs-6 col-sm-6 col-md-6 my-col">',t+='<div class="inTop">',t+='<p class="nowrap">'+a[s].itemName+"&nbsp;</p>",t+="</div>",t+='<div class="inBottom">',t+='<p class="count">￥<span>'+a[s].expenseTotal+"</span></p>",t+="</div>",t+="</div>",t+='<div class="col-xs-3 col-sm-3 col-md-3 my-col text-right">',t+='<div class="inTop">',t+=""+n,t+="</div>",t+='<div class="inBottom">',t+="<span>"+a[s].updateTime.substring(6)+" <span></span></span>",t+="</div></div></div></div></li>"}$($my.inWrap).append(t),$my.flag=!1},scrollEvent:function(){var a=$my.loadingWrap.getBoundingClientRect();if(!$my.flag){if(!(a.top<$my.vpHeight&&a.bottom>=0))return;if($my.flag=!0,++$my.num>parseInt(approval.dataCount/pageSize)||$my.num==parseInt(approval.dataCount/pageSize)&&approval.dataCount%pageSize==0)return $(".loading").hide(),$my.lodingText.classList.add("lodingText_show"),!1;approval.getData($my.userID,$my.num,pageSize)}},viewDetail:function(){var a=function(){var a=this.dataset.detailid,t=this.dataset.status;window.location.href="detail_approval.html?detailid="+a+"#status="+t};$($my.inWrap).on("click","li",function(t){t.preventDefault(),t.stopPropagation(),approval.throttle(a,this)})}};var approval=new Approval;$(function(){window.$my={messageInfo:$(".messageInfo"),userID:sessionStorage.getItem("ddUserID"),loadingWrap:document.querySelector("#loadingWrap"),lodingText:document.querySelector("#lodingText"),inWrap:document.querySelector(".inWrap"),wrap:document.querySelector(".wrap"),vpHeight:document.documentElement.clientHeight,num:0,flag:!1},approval.getData($my.userID,0,pageSize),window.addEventListener("touchmove",approval.touchThrottle(approval.scrollEvent,500,1e3)),approval.viewDetail()});