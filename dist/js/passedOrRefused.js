"use strict";function Approval(){this.expenseID="",this.expenseReviewID="",this.config={passedBtn:document.querySelector("#passedBtn"),inputContent:document.querySelector("#inputContent")}}Approval.prototype={constructor:Approval,throttle:function(e,t){clearTimeout(e.tId),e.tId=setTimeout(function(){e.call(t)},1e3)},getUrlArguments:function(){var e=window.location.href,t=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null};if(-1==e.indexOf("expenseID")||-1==e.indexOf("expenseReviewID"))throw $my.messageInfo.html("url错误").fadeIn("fast").delay("1000").fadeOut("slow"),new Error("url错误");this.expenseID=t("expenseID"),this.expenseReviewID=t("expenseReviewID")},_passedFn:function(){var e=approval.config.passedBtn.dataset.reviewtype,t=approval.config.inputContent.value;if(""==t)return void $my.messageInfo.html("请输入审批内容").fadeIn("fast").delay("1500").fadeOut("slow");$.ajax({url:getRoothPath+"/ddExpenses/review/updataExpenseReview.do",data:{expenseID:approval.expenseID,expenseReviewID:approval.expenseReviewID,reviewType:e,expenselog:t},success:function(e){if("{}"===JSON.stringify(e))return $my.messageInfo.html("暂无数据").fadeIn("fast").delay("1000").fadeOut("slow"),!1;switch(e.status){case 1:var t=null;$my.messageInfo.html(e.msg).fadeIn("fast").delay("1000").fadeOut("slow"),function(){localStorage.removeItem("sessionTouchData_mySponser"),localStorage.removeItem("pageNum_mySponser"),localStorage.removeItem("dataCount_mySponser"),localStorage.removeItem("sessionTouchData_myApproval"),localStorage.removeItem("pageNum_myApproval"),localStorage.removeItem("dataCount_myApproval")}(),clearTimeout(t),t=setTimeout(function(){window.location.href="index.html"},1200);break;case 0:$my.messageInfo.html("提交失败").fadeIn("fast").delay("1500").fadeOut("slow")}}})},submitEvent:function(){var e=this;e.config.passedBtn.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),e.throttle(e._passedFn,this)},!1)}};var approval=new Approval;$(function(){window.$my={messageInfo:$(".messageInfo")},approval.getUrlArguments(),approval.submitEvent()});